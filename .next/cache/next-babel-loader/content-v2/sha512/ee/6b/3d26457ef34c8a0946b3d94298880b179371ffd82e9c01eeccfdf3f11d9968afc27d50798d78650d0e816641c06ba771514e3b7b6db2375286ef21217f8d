{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/trevorb/Documents/VSCode Projects/trendtubes/auth/auth-data.tsx\",\n    _this = this;\n\nimport { faDiscord } from '@fortawesome/free-brands-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\nimport { Button } from '../components/button';\nimport { BackendApi } from '../utils/backend-api';\n\nvar AuthDataWrapper = function AuthDataWrapper(_ref) {\n  var user = _ref.user,\n      permissions = _ref.permissions,\n      children = _ref.children;\n  console.log('AUTH DATA WRAPPER', user);\n\n  if (user && Object.keys(user).length && user._id) {\n    if (permissions && (!user.permissions || !permissions.every(function (perm) {\n      return user.permissions.includes(perm);\n    }))) {\n      return /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-screen flex flex-col items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 bg-secondary-bg rounded-md flex flex-col items-center\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"You do not have the proper permissions to view this page.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 27,\n              columnNumber: 8\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 26,\n            columnNumber: 7\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 5\n      }, _this);\n    }\n\n    return children;\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"h-screen flex flex-col items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 bg-secondary-bg rounded-md flex flex-col items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"You are not authenticated. Access denied.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 7\n          }, _this), /*#__PURE__*/_jsxDEV(Button, {\n            className: \"space-x-2 flex items-center mt-4\",\n            href: \"http://localhost:3005/auth\",\n            children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faDiscord\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 8\n            }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Login via Discord\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 45,\n              columnNumber: 8\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 7\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 5\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 4\n    }, _this);\n  }\n};\n\n_c = AuthDataWrapper;\n\nvar authDataCtx = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(ctx) {\n    var user, authInfoResponse;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            user = null;\n            console.log('COOKIE CTX', ctx.req.headers.cookie); // var cookie = ctx.req.headers.cookie;\n\n            _context.prev = 2;\n            _context.next = 5;\n            return BackendApi.getAuthInfo(ctx.req.headers.cookie || '')[\"catch\"](function () {\n              return {\n                data: {}\n              };\n            });\n\n          case 5:\n            authInfoResponse = _context.sent;\n\n            if (authInfoResponse && authInfoResponse.data) {\n              user = authInfoResponse === null || authInfoResponse === void 0 ? void 0 : authInfoResponse.data;\n            }\n\n            _context.next = 11;\n            break;\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](2);\n\n          case 11:\n            return _context.abrupt(\"return\", {\n              user: user\n            });\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 9]]);\n  }));\n\n  return function authDataCtx(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport { AuthDataWrapper, authDataCtx };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthDataWrapper\");","map":{"version":3,"sources":["/home/trevorb/Documents/VSCode Projects/trendtubes/auth/auth-data.tsx"],"names":["faDiscord","FontAwesomeIcon","React","Button","BackendApi","AuthDataWrapper","user","permissions","children","console","log","Object","keys","length","_id","every","perm","includes","authDataCtx","ctx","req","headers","cookie","getAuthInfo","data","authInfoResponse"],"mappings":"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","sourcesContent":["import { faDiscord } from '@fortawesome/free-brands-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\nimport { Button } from '../components/button';\nimport { BackendApi } from '../utils/backend-api';\n\nconst AuthDataWrapper = ({\n\tuser,\n\tpermissions,\n\tchildren,\n}: {\n\tuser: any;\n\tpermissions?: string[];\n\tchildren: any;\n}) => {\n\tconsole.log('AUTH DATA WRAPPER', user);\n\tif (user && Object.keys(user).length && user._id) {\n\t\tif (\n\t\t\tpermissions &&\n\t\t\t(!user.permissions ||\n\t\t\t\t!permissions.every((perm) => user.permissions.includes(perm)))\n\t\t) {\n\t\t\treturn (\n\t\t\t\t<main className=\"\">\n\t\t\t\t\t<div className=\"h-screen flex flex-col items-center justify-center\">\n\t\t\t\t\t\t<div className=\"p-6 bg-secondary-bg rounded-md flex flex-col items-center\">\n\t\t\t\t\t\t\t<p>You do not have the proper permissions to view this page.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\t\t\t);\n\t\t}\n\t\treturn children;\n\t} else {\n\t\treturn (\n\t\t\t<main className=\"\">\n\t\t\t\t<div className=\"h-screen flex flex-col items-center justify-center\">\n\t\t\t\t\t<div className=\"p-6 bg-secondary-bg rounded-md flex flex-col items-center\">\n\t\t\t\t\t\t<p>You are not authenticated. Access denied.</p>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"space-x-2 flex items-center mt-4\"\n\t\t\t\t\t\t\thref=\"http://localhost:3005/auth\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FontAwesomeIcon icon={faDiscord} />\n\t\t\t\t\t\t\t<span>Login via Discord</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t);\n\t}\n};\n\nconst authDataCtx = async (ctx: any) => {\n\tvar user = null;\n\tconsole.log('COOKIE CTX', ctx.req.headers.cookie);\n\t// var cookie = ctx.req.headers.cookie;\n\ttry {\n\t\tconst authInfoResponse = await BackendApi.getAuthInfo(\n\t\t\tctx.req.headers.cookie || ''\n\t\t).catch(() => {\n\t\t\treturn { data: {} };\n\t\t});\n\t\tif (authInfoResponse && authInfoResponse.data) {\n\t\t\tuser = authInfoResponse?.data;\n\t\t}\n\t} catch (e) {}\n\treturn { user };\n};\n\nexport { AuthDataWrapper, authDataCtx };\n"]},"metadata":{},"sourceType":"module"}